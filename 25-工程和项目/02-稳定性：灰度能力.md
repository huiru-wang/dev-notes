---
title: 系统稳定性：灰度能力
category: DistSystem
tags:
  - systemDesign
  - stability
publishedAt: 2024-10-03
description: 在阿里工作之前，并没有了解过灰度能力，直到接触到了敏捷开发，灰度能力对快速地产品迭代及其重要
---
# 灰度能力

灰度能力不仅是软件开发的重要能力，更是产品、运营的重要手段。
## 2.1 什么是灰度

![](/images/工程能力-稳定性-灰度能力.png)

灰度(Gray Scale)是一种<font color="#de7802">流量分配策略</font>，对于新发布的功能，将流量从少到多逐步平滑的分配到新的产品功能、代码逻辑中；

## 2.2 灰度的实现和放量策略

灰度可以是物理灰度，也可以是逻辑灰度。
- <font color="#de7802">物理灰度</font>：根据Server节点进行灰度，新版本的代码或功能优先部署在部分节点上；
- <font color="#de7802">逻辑灰度</font>：根据特定的逻辑判断，来将流量分配到不同的功能或代码上，能够更精准的控制流量；

放量策略：
- <font color="#de7802">百分比放量</font>：直接按照流量的大小，进行百分比逐步放量；
- <font color="#de7802">依据特定的流量标识放量</font>：依据产品的特性，按照特定的划分逻辑进行放量；
	- 渠道；
	- 人群；
	- 用户；

## 2.3 灰度的意义

### 2.3.1 降低风险以及保障业务连续性

首先是降低技术变更带来的风险；<font color="#de7802">你永远无法保证上线的新代码不会出问题</font>，甚至某些情况下<font color="#de7802">无法确定风险影响范围</font>。

灰度能力可以确保新的代码逻辑<font color="#de7802">先由小部分的流量进行验证</font>，降低可能带来的风险影响范围。

其次是业务风险，新的业务功能、商业模式，可能带来潜在的用户体验风险，灰度能力同样可以将这些风险控制在较低的水平，以此来逐步验证。

因此，灰度让产品的迭代可以<font color="#de7802">平滑过度</font>的同时，也能确保当潜在的风险发生时，以最快的实现<font color="#de7802">回滚</font>。

### 2.3.2 优化用户体验

依据特定的流量标识进行灰度，可以使得更具有代表性的用户来反映出新的业务功能的<font color="#de7802">有效性</font>，同时能更<font color="#de7802">精准地收集到符合用户需求的反馈</font>，从而更好的制定产品的下一步策略，更好的提升用户体验。


### 2.3.3 提升运营效率

<font color="#de7802">灰度能力对流量的分配，也就意味着对资源的合理分配</font>。

比如说特定的产品广告、推广，可以依赖灰度来完成更精准的分配。